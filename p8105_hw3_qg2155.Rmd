---
title: "p8105_hw3_qg2155"
author: "Qiu Xia (Helen) Guan"
date: "10/11/2018"
output: github_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(tidyverse)
library(patchwork)
library(p8105.datasets)
```

```{r page setup}
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = 1.3,
  out.width = "90%"
)

theme_set(theme_bw() + theme(legend.position = "bottom"))
```

## Problem 1

### Load and clean BRFSS dataset 

```{r get brfss}
data("brfss_smart2010")
```

```{r clean brfss}
brfss_data = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  mutate(response = factor(response))
```

### Summarizing distinct locations 

```{r states}
brfss_data %>% 
  filter(year == 2002) %>% 
  group_by(locationabbr) %>%
  summarize(n_locations = n_distinct(locationdesc))
```

In 2002, there were 3 states that were observed at 7 locations. These 3 states were CT, FL, and NC. 

### Creating spaghetti plot of number locations 

```{r spaghetti plot}
brfss_data %>% 
  group_by(locationabbr, year) %>%
  summarize(n_locations = n_distinct(locationdesc)) %>% 
  ggplot(aes(x = year, y = n_locations, color = locationabbr)) + 
    geom_point() + geom_line()
```

This spaghetti plot shows the number of locations in each state from 2002 to 2010. Florida in particular seems to have over 40 distinct loactions in two different time points. 

### Table for mean and standard deviation of "Excellent" responses in NY

```{r  excellent responses}
brfss_data %>%
  group_by(year) %>% 
  filter(year == 2002 | year == 2006 | year == 2010) %>% 
  spread(key = response, value = data_value) %>% 
  janitor::clean_names() %>% 
  filter(locationabbr == "NY") %>% 
  summarize(mean_excellent = mean(excellent, na.rm = TRUE),
            sd_excellent = sd(excellent, na.rm = TRUE)) %>% 
  knitr::kable(digits = 1)
```

Witin the state of New York, 2002 has the highest average of 24% for excellent responses, and a standard deviation of 4.5. Year 2006 has an average of 22.5% and standard deviation of 4.0. Year 2010 has an average of 22.7% and standard deviation of 3.6. 

### Plot for distribution of each response category across states

```{r five plots}
brfss_data %>% 
  group_by(year, locationabbr, response) %>%
  summarize(mean_response = mean(data_value, na.rm = TRUE)) %>% 
  ggplot(aes(x = year, y = mean_response)) +
    geom_violin() +
    facet_grid(. ~ response) 
```

Across all states and years, the response category of "Good" seems to have the highest average, followed by "Excellent", "Fair", and "Poor". Excellent seems to have the biggest range out of them all. 

## Problem 2

### Load and clean dataset

```{r get instacart}
data("instacart")
```

```{r clean instacart}
instacart_data = instacart %>% 
  janitor::clean_names() 
```

```{r most items}
instacart_data %>% 
summarize(n_aisles = n_distinct(aisle_id))
```

There are `r instacart_data %>% summarize(n_aisles = n_distinct(aisle_id))` aisles. 
